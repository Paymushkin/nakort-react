# Отправка заявок в Google Таблицу

Данные из модальных окон «Записаться на тренировку» и «Купить сертификат» отправляются в [таблицу NAKORT](https://docs.google.com/spreadsheets/d/102VwWrCHIVKI2ImByDJZ3Y7oO9N6sKDz7bD8aGFC_C4/edit?gid=0#gid=0) через Google Apps Script. Запросы идут через API `/api/submit-to-sheets`, который проксирует данные в Apps Script (обходит CORS).

## 1. Настройка Google Apps Script

1. Откройте таблицу по ссылке выше.
2. **Расширения → Apps Script**.
3. Удалите шаблон `function myFunction() {}` и вставьте код из `scripts/NAKORT-Google-Apps-Script.gs`. Сохраните (Ctrl+S).
4. **Развернуть → Новое развёртывание**:
   - **Тип**: Веб-приложение
   - **Описание**: например, `NAKORT forms`
   - **Выполнять от имени**: **Я** (ваш аккаунт)
   - **У кого есть доступ**: **Все пользователи** (иначе запросы с сайта не пройдут)
5. Нажмите **Развернуть**. Скопируйте **URL веб-приложения** (оканчивается на `/exec`).

## 2. Переменная окружения

Создайте в корне проекта файл `.env.local`:

```env
NEXT_PUBLIC_GOOGLE_SCRIPT_URL=https://script.google.com/macros/s/ВАШ_ID/exec
```

Подставьте вместо `ВАШ_ID` скопированный URL (или весь URL, если он уже полный).

После изменения `.env.local` перезапустите `npm run dev` / сборку.

## 3. Колонки в таблице

При первой отправке скрипт создаёт заголовки на первом листе:

| A      | B     | C          | D       | E    | F       | G         |
|--------|-------|------------|---------|------|---------|-----------|
| Дата   | Форма | Вид спорта | Формат  | Имя  | Телефон | Согласия  |

- **Форма**: `training` или `certificate`
- **Согласия**: `да`, если отмечены оба чекбокса

## 4. Обновление скрипта

После правок в `scripts/NAKORT-Google-Apps-Script.gs` в редакторе Apps Script: **Развернуть → Управление развёртываниями → Карандаш (изменить) → Версия: новая версия → Развернуть**. URL не меняется.
